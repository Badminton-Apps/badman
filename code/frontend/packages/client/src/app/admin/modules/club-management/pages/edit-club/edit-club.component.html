<div class="mat-subheading-1">Edit Club</div>

<ng-container *ngIf="this.club$ | async as club">
  <app-has-claim [any]="[club.id + '_edit:club', 'edit-any:club']">
    <app-club-fields [club]="club" (save)="this.save($event)"></app-club-fields>
    <div noPerm>{{ club.name }}</div>
  </app-has-claim>

  <app-has-claim [any]="[club.id + '_edit:location', club.id + '_edit:club', 'edit-any:club']">
    <div class="mat-subheading-1">
      Locations

      <app-has-claim [any]="[club.id + '_add:locations', club.id + '_edit:club', 'edit-any:club']">
        <button mat-icon-button (click)="this.onEditLocation(null, club)">
          <mat-icon>add</mat-icon>
        </button>
      </app-has-claim>
    </div>
    <div class="locations" fxLayout="row wrap" fxLayoutGap="16px grid">
      <app-club-edit-location
        *ngFor="let location of club.locations"
        [location]="location"
        [club]="club"
        (onEdit)="this.onEditLocation($event, club)"
        (onDelete)="this.onDeleteLocation($event)"
      >
      </app-club-edit-location>
    </div>
  </app-has-claim>

  <app-has-claim [any]="[club.id + '_edit:role', club.id + '_edit:club', 'edit-any:club']">
    <div class="mat-subheading-1">
      Roles
      <app-has-claim [any]="[club.id + '_add:role', club.id + '_edit:club', 'edit-any:club']">
        <button mat-icon-button [routerLink]="['/', 'admin', 'club', club.id, 'edit', 'role', 'add']">
          <mat-icon>add</mat-icon>
        </button>
      </app-has-claim>
    </div>
    <div class="roles" fxLayout="row wrap" fxLayoutGap="16px grid">
      <app-club-edit-role
        *ngFor="let role of club.roles"
        [role]="role"
        [club]="club"
        (onPlayerAdded)="this.onPlayerAddedToRole($event, role)"
        (onPlayerRemoved)="this.onPlayerRemovedFromRole($event, role)"
        (onEdit)="this.onEditRole($event, club)"
        (onDelete)="this.onDeleteRole($event)"
      >
      </app-club-edit-role>
    </div>
  </app-has-claim>

  <app-has-claim [any]="['change-base:team']">
    <div class="mat-subheading-1">Base players</div>
    <mat-form-field appearance="outline" class="flex">
      <mat-label>{{ 'pickers.select-year' | translate }}</mat-label>
      <mat-select [formControl]="this.competitionYear">
        <mat-option *ngFor="let option of this.compYears$ | async" [value]="option">
          {{ option }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <div class="teams" fxLayout="row wrap" fxLayoutGap="16px grid">
      <app-club-edit-team
        *ngFor="let team of this.teamsForYear$ | async"
        [team]="team"
        [club]="club"
        (onPlayerAdded)="this.onAddBasePlayer($event, team)"
        (onPlayerRemoved)="this.onDeleteBasePlayer($event, team)"
      >
      </app-club-edit-team>
    </div>
  </app-has-claim>
</ng-container>
