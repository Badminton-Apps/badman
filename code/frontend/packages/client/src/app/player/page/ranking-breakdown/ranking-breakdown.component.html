<ng-container *ngIf="this.data$ | async as data; else loading">
  <div class="mat-subheading-1">
    <button mat-icon-button [routerLink]="['/player', data.player.id]"><mat-icon>arrow_back</mat-icon></button
    >{{ 'breakdown.title' | translate }}
  </div>

  <div fxLayout="column">
    <div class="mat-subheading-2">{{ 'breakdown.evolution' | translate }}</div>
    <app-ranking-evolution [player]="data.player" fxLayout="row" fxLayout.lt-md="column"> </app-ranking-evolution>

    <div class="mat-subheading-2">
      {{ 'breakdown.pointsPerGame' | translate }}
      <app-beta></app-beta>
    </div>
    <p class="disclaimer">
      {{ 'breakdown.disclaimer' | translate }}
    </p>

    <form [formGroup]="this.gameFilter" fxFlex fxLayout="row" fxLayout.lt-md="column" fxLayoutGap="10px">
      <mat-form-field appearance="outline" fxFlex="200px" fxFlex.lt-md>
        <mat-label>{{ 'game.type' | translate }}</mat-label>
        <mat-select formControlName="gameType">
          <mat-option value="single">{{ 'systems.single' | translate }}</mat-option>
          <mat-option value="double">{{ 'systems.double' | translate }}</mat-option>
          <mat-option value="mix">{{ 'systems.mix' | translate }}</mat-option>
        </mat-select>
      </mat-form-field>

      <app-period-selection
        (onNext)="this.nextPeriod(data.system)"
        (onPrev)="this.prevPeriod(data.system)"
        [formGroup]="this.period"
      ></app-period-selection>
    </form>
    <app-list-games
      *ngIf="!loadingData; else loading"
      [system]="data.system"
      [games]="data.games"
      [playerId]="data.player.id!"
      [type]="data.type"
      [formGroup]="this.gameFilter"
    ></app-list-games>
  </div>
</ng-container>

<ng-template #loading>
  <mat-progress-bar mode="indeterminate"></mat-progress-bar>
</ng-template>
