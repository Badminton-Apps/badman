<div class="mat-subheading-1">Ennroll for competition</div>
<div>
  note: Changes are saved directly
</div>

<mat-vertical-stepper [linear]="true" #stepper (selectionChange)="this.changStepper($event)">
  <mat-step [stepControl]="this.formGroup" *ngIf="this.formGroup">
    <form [formGroup]="this.formGroup">
      <ng-template matStepLabel>Select club & competition</ng-template>

      <app-select-club [formGroup]="this.formGroup"></app-select-club>

      <div class="row">
        <mat-checkbox formControlName="enabledNational">
          National
        </mat-checkbox>
      </div>
      <div class="row">
        <mat-checkbox formControlName="enabledLiga">
          Liga
        </mat-checkbox>
      </div>

      <div class="row">
        <mat-checkbox formControlName="enabledProvincial">
          Prov
        </mat-checkbox>
      </div>

      <div class="row">
        <ng-container *ngIf="this.enabledProvincialControl.value">
          <app-select-event [formGroup]="formGroup"></app-select-event>
        </ng-container>
      </div>

      <div>
        <button mat-button matStepperNext>Next</button>
      </div>
    </form>
  </mat-step>
  <mat-step>
    <ng-template matStepLabel>Assign your teams</ng-template>


    <ng-container *ngIf="this.show$ | async as teamInfo; else loading">
      <ng-container *ngIf="this.subEventsInitialized; else loading">
        <app-assign-team (onChange)="this.teamsAssigned($event)" [club]="teamInfo.club" [type]="'competition.types.male' | translate" [teams]="teamInfo.teamsM" [subEvents]="teamInfo.subEventM"></app-assign-team>
        <app-assign-team (onChange)="this.teamsAssigned($event)" [club]="teamInfo.club" [type]="'competition.types.mix' | translate" [teams]="teamInfo.teamsMX" [subEvents]="teamInfo.subEventMX"></app-assign-team>
        <app-assign-team (onChange)="this.teamsAssigned($event)" [club]="teamInfo.club" [type]="'competition.types.female' | translate" [teams]="teamInfo.teamsF" [subEvents]="teamInfo.subEventF"></app-assign-team>
      </ng-container>
    </ng-container>

    <ng-template #loading>
      loading ....
      <mat-progress-bar mode="indeterminate"></mat-progress-bar>
    </ng-template>

    <div>
      <button mat-button matStepperPrevious>Back</button>
      <button mat-button matStepperNext>Next</button>
    </div>
  </mat-step>
  <mat-step>
    <ng-template matStepLabel>Location(s)</ng-template>


    <ng-container *ngIf="this.club$ | async as club; else loading">
      <p>Select the locations that apply for each event</p>
      <ng-container *ngIf="this.natEvent$ | async as nat ">
        <div class="mat-subheading-2">{{ nat.name}}</div>
        <app-assign-location (onChange)="this.locationAssigned($event)" [locations]="club.locations" [event]="nat"></app-assign-location>
      </ng-container>

      <ng-container *ngIf="this.ligaEvent$ | async as liga ">
        <div class="mat-subheading-2">{{ liga.name}}</div>
        <app-assign-location (onChange)="this.locationAssigned($event)" [locations]="club.locations" [event]="liga"></app-assign-location>
      </ng-container>

      <ng-container *ngIf="this.provEvent$ | async as prov ">
        <div class="mat-subheading-2">{{ prov.name}}</div>
        <app-assign-location (onChange)="this.locationAssigned($event)" [locations]="club.locations" [event]="prov"></app-assign-location>
      </ng-container>
    </ng-container>

    <ng-template #loading>
      loading ....
      <mat-progress-bar mode="indeterminate"></mat-progress-bar>
    </ng-template>

    <div>
      <button mat-button matStepperPrevious>Back</button>
      <button mat-button matStepperNext>Next</button>
    </div>
  </mat-step>
  <mat-step>
    <ng-template matStepLabel>Done</ng-template>
    You are now done.
    <div>
      <button mat-button matStepperPrevious>Back</button>
      <button mat-button (click)="stepper.reset()">Reset</button>
    </div>
  </mat-step>
</mat-vertical-stepper>
