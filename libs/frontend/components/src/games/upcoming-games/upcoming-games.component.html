<mat-list role="list">
  @for (upcoming of this.upcommingGames.games(); track upcoming.id) {
    <mat-list-item role="listitem">
      <span
        matListItemTitle
        [routerLink]="[
          '/',
          'competition',
          upcoming.drawCompetition?.subEventCompetition?.eventId,
          'draw',
          upcoming.drawCompetition?.id,
          'encounter',
          upcoming.id
        ]"
        >{{ upcoming?.date | amDateFormat: 'llll' }}</span
      >
      <span matListItemLine
        ><ng-container
          *ngIf="this.upcommingGames.hasHomeTeam()"
          [ngTemplateOutlet]="hasHome"
          [ngTemplateOutletContext]="{ upcoming: upcoming }"
        ></ng-container
        ><ng-container
          *ngIf="!this.upcommingGames.hasHomeTeam()"
          [ngTemplateOutlet]="noHome"
          [ngTemplateOutletContext]="{ upcoming: upcoming }"
        ></ng-container>
      </span>
    </mat-list-item>
  }

  @if (this.upcommingGames.loading()) {
    <badman-loading-block [items]="5" height="56px" />
  } @else if (this.upcommingGames.endReached()) {
    <div class="no-more-games" translate="all.competition.no-more-games"></div>
  }

  <mat-list-item role="listitem">
    <!--  a button to load more -->
    <ng-container
      *ngIf="
        !this.upcommingGames.endReached() && !this.upcommingGames.loading()
      "
    >
      <button mat-button (click)="loadMore()">
        {{ 'all.competition.load-more' | translate }}
      </button>
    </ng-container>
    <ng-container
      *ngIf="this.upcommingGames.endReached() && !this.upcommingGames.loading()"
    >
      <span
        matListItemLine
        class="no-more-encounters"
        translate="all.competition.encounters.no-more"
      ></span>
    </ng-container>
  </mat-list-item>
</mat-list>

<ng-template #noHome let-upcoming="upcoming">
  <span
    >{{ upcoming.home?.name }} <span translate="all.competition.vs"></span>
    {{ upcoming.away?.name }}
  </span>
</ng-template>

<ng-template #hasHome let-upcoming="upcoming">
  <span class="location"
    >{{
      'all.competition.' + (upcoming.showingForHomeTeam ? 'home' : 'away')
        | translate
    }}
    -
  </span>
  <ng-container
    *ngIf="upcoming.showingForHomeTeam && upcoming?.home?.club?.slug"
    ><a
      [routerLink]="[
        '/club',
        upcoming.home.club.slug,
        'team',
        upcoming.home?.slug
      ]"
      >{{ upcoming.home?.name }}</a
    >
  </ng-container>
  <ng-container
    *ngIf="!upcoming.showingForHomeTeam && upcoming?.away?.club?.slug"
    ><a
      [routerLink]="[
        '/club',
        upcoming.away.club.slug,
        'team',
        upcoming.away?.slug
      ]"
      >{{ upcoming.away?.name }}</a
    >
  </ng-container>

  <span>&nbsp;{{ 'all.competition.vs' | translate }}&nbsp;</span>

  <ng-container
    *ngIf="upcoming.showingForHomeTeam && upcoming?.away?.club?.slug"
    ><a
      [routerLink]="[
        '/club',
        upcoming.away.club.slug,
        'team',
        upcoming.away?.slug
      ]"
      >{{ upcoming.away?.name }}</a
    >
  </ng-container>

  <ng-container
    *ngIf="!upcoming.showingForHomeTeam && upcoming?.home?.club?.slug"
    ><a
      [routerLink]="[
        '/club',
        upcoming.home.club.slug,
        'team',
        upcoming.home?.slug
      ]"
      >{{ upcoming.home?.name }}</a
    >
  </ng-container>
</ng-template>
